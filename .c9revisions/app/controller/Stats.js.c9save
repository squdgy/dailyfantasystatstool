{"ts":1340374405662,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"Ext.define('DFST.controller.Stats', {\n    extend: 'Ext.app.Controller',\n\n    stores: ['Stats', 'PlayerStats'],\n\n    models: ['StatSet', 'PlayerStatSet'],\n\n    views: ['statset.Grid', 'statset.PlayerGrid', 'drilldown.Details', 'drilldown.DetailInfo'],\n\n    refs: [{\n    \tref: 'drilldowndetails',\n    \tselector: 'drilldowndetails'\n    }, {\n        ref: 'drilldowninfo',\n    \tselector: 'drilldowninfo'\n    }],\n\n    init: function() {\n        // Set up service URLs\n        var host = 'http://localhost:49533';    //local\n        if (location.hostname.indexOf('cloudapp.net') > 0) {\n            host = 'http://dfst.cloudapp.net';  //live azure\n        }\n//        host = 'http://localhost:81';       //local azure dev fabric \n        var statsStore = this.getStatsStore();\n        var playerStatsStore = this.getPlayerStatsStore();\n        statsStore.proxy.url = host + '/api/players/';\n        playerStatsStore.proxy.url = host + '/api/playerstats/';\n\n        this.control({\n            'statsetgrid': {\n                selectionchange: this.drillDown\n            },\n            'statsetgrid > tableview': {\n                itemdblclick: this.loadStatSet,\n                refresh: this.selectStatSet\n            }\n        });\n    },\n    \n    selectStatSet: function(view) {\n        var first = this.getStatsStore().getAt(0);\n        if (first) {\n            view.getSelectionModel().select(first);\n        }\n    },\n\n    /**\n     * Loads the given statset into the drilldown view\n     * @param {DFST.model.StatSet} statset The statset to load\n     */\n    drillDown: function(grid, statsets) {\n        var statset = statsets[0],\n            detailsInfoView = this.getDrilldowninfo(),\n            detailsView = this.getDrilldowndetails(),\n            siteId=this.getStatsStore().filters.get(\"scoring\").value,\n            store;\n\n        if (statset && detailsView) {\n            store = this.getPlayerStatsStore();\n            store.filter([\n                {id:'id', property: 'id', value: statset.data.id},\n                {id:'scoring', property: 'scoring', value: siteId}\n            ]);\n            detailsInfoView.statset = statset;\n            detailsInfoView.update(statset.data);\n            detailsView.setTitle('Game Details: ' + statset.data.name);\n            detailsView.show();\n        }\n    }});\n\n"]],"start1":0,"start2":0,"length1":0,"length2":2307}]],"length":2307}
{"contributors":[],"silentsave":false,"ts":1359300940397,"patch":[[{"diffs":[[0,"      }\n"],[-1,"//"],[0,"        "]],"start1":642,"start2":642,"length1":18,"length2":16}]],"length":2305,"saved":false}
{"ts":1359301101252,"patch":[[{"diffs":[[0,"azure\n        }\n"],[1,"//"],[0,"        host = '"]],"start1":634,"start2":634,"length1":32,"length2":34}]],"length":2307,"saved":false}
{"contributors":[],"silentsave":false,"ts":1359824054243,"patch":[[{"diffs":[[0,"    site"],[-1,"Id"],[1,"Abb"],[0,"=this.ge"]],"start1":1741,"start2":1741,"length1":18,"length2":19},{"diffs":[[0,"site"],[-1,"Id"],[1,"Abb"],[0,"}\n  "]],"start1":2063,"start2":2063,"length1":10,"length2":11}]],"length":2309,"saved":false}
{"contributors":[],"silentsave":false,"ts":1359830608016,"patch":[[{"diffs":[[0,"ue: site"],[-1,"Abb"],[1,"Id"],[0,"}\n      "]],"start1":2059,"start2":2059,"length1":19,"length2":18}]],"length":2308,"saved":false}
{"ts":1359830868474,"patch":[[{"diffs":[[0,"site"],[-1,"Abb"],[1,"Id"],[0,"=thi"]],"start1":1745,"start2":1745,"length1":11,"length2":10},{"diffs":[[0,"value: s"],[-1,"ite"],[1,"tat"],[0,"Id}\n    "]],"start1":2055,"start2":2055,"length1":19,"length2":19}]],"length":2307,"saved":false}
{"ts":1359830884158,"patch":[[{"diffs":[[0,"value: s"],[-1,"tat"],[1,"ite"],[0,"Id}\n    "]],"start1":2055,"start2":2055,"length1":19,"length2":19}]],"length":2307,"saved":false}
{"contributors":[],"silentsave":false,"ts":1360515498751,"patch":[[{"diffs":[[0,"ndexOf('"],[-1,"cloudapp.net"],[1,"azurewebites"],[0,"') > 0) "]],"start1":549,"start2":549,"length1":28,"length2":28}]],"length":2307,"saved":false}
{"ts":1360515544015,"patch":[[{"diffs":[[0,"azureweb"],[1,"s"],[0,"ites') >"]],"start1":557,"start2":557,"length1":16,"length2":17}]],"length":2308,"saved":false}
{"ts":1360519378059,"patch":[[{"diffs":[[0,"p://dfst"],[1,"api"],[0,".cloudap"]],"start1":603,"start2":603,"length1":16,"length2":19}]],"length":2311,"saved":false}
